<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Paired data | Data analysis for Newquay University Centre</title>
  <meta name="description" content="<p>This is the main text for those at Newquay University Centre who wih to analyse
their data. The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Paired data | Data analysis for Newquay University Centre" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is the main text for those at Newquay University Centre who wih to analyse
their data. The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Paired data | Data analysis for Newquay University Centre" />
  
  <meta name="twitter:description" content="<p>This is the main text for those at Newquay University Centre who wih to analyse
their data. The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Michael Hunt" />


<meta name="date" content="2024-05-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="one-way-anova.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#render-book"><i class="fa fa-check"></i><b>1.2</b> Render book</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#preview-book"><i class="fa fa-check"></i><b>1.3</b> Preview book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hello-bookdown.html"><a href="hello-bookdown.html"><i class="fa fa-check"></i><b>2</b> Hello bookdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="hello-bookdown.html"><a href="hello-bookdown.html#a-section"><i class="fa fa-check"></i><b>2.1</b> A section</a>
<ul>
<li class="chapter" data-level="" data-path="hello-bookdown.html"><a href="hello-bookdown.html#an-unnumbered-section"><i class="fa fa-check"></i>An unnumbered section</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>3</b> Cross-references</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cross.html"><a href="cross.html#chapters-and-sub-chapters"><i class="fa fa-check"></i><b>3.1</b> Chapters and sub-chapters</a></li>
<li class="chapter" data-level="3.2" data-path="cross.html"><a href="cross.html#captioned-figures-and-tables"><i class="fa fa-check"></i><b>3.2</b> Captioned figures and tables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="parts.html"><a href="parts.html"><i class="fa fa-check"></i><b>4</b> Parts</a></li>
<li class="chapter" data-level="5" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html"><i class="fa fa-check"></i><b>5</b> Footnotes and citations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#footnotes"><i class="fa fa-check"></i><b>5.1</b> Footnotes</a></li>
<li class="chapter" data-level="5.2" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#citations"><i class="fa fa-check"></i><b>5.2</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>6</b> Blocks</a>
<ul>
<li class="chapter" data-level="6.1" data-path="blocks.html"><a href="blocks.html#equations"><i class="fa fa-check"></i><b>6.1</b> Equations</a></li>
<li class="chapter" data-level="6.2" data-path="blocks.html"><a href="blocks.html#theorems-and-proofs"><i class="fa fa-check"></i><b>6.2</b> Theorems and proofs</a></li>
<li class="chapter" data-level="6.3" data-path="blocks.html"><a href="blocks.html#callout-blocks"><i class="fa fa-check"></i><b>6.3</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sharing-your-book.html"><a href="sharing-your-book.html"><i class="fa fa-check"></i><b>7</b> Sharing your book</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sharing-your-book.html"><a href="sharing-your-book.html#publishing"><i class="fa fa-check"></i><b>7.1</b> Publishing</a></li>
<li class="chapter" data-level="7.2" data-path="sharing-your-book.html"><a href="sharing-your-book.html#pages"><i class="fa fa-check"></i><b>7.2</b> 404 pages</a></li>
<li class="chapter" data-level="7.3" data-path="sharing-your-book.html"><a href="sharing-your-book.html#metadata-for-sharing"><i class="fa fa-check"></i><b>7.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="8" data-path="one-way-anova.html"><a href="one-way-anova.html"><i class="fa fa-check"></i><b>8</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="8.1" data-path="one-way-anova.html"><a href="one-way-anova.html#load-packages"><i class="fa fa-check"></i><b>8.1</b> Load packages</a></li>
<li class="chapter" data-level="8.2" data-path="one-way-anova.html"><a href="one-way-anova.html#remove-observations-with-missing-values"><i class="fa fa-check"></i><b>8.2</b> Remove observations with missing values</a></li>
<li class="chapter" data-level="8.3" data-path="one-way-anova.html"><a href="one-way-anova.html#summary---group-by-species-and-sex"><i class="fa fa-check"></i><b>8.3</b> Summary - group by species and sex</a></li>
<li class="chapter" data-level="8.4" data-path="one-way-anova.html"><a href="one-way-anova.html#plot-the-data"><i class="fa fa-check"></i><b>8.4</b> Plot the data</a></li>
<li class="chapter" data-level="8.5" data-path="one-way-anova.html"><a href="one-way-anova.html#one-way-anova-1"><i class="fa fa-check"></i><b>8.5</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="one-way-anova.html"><a href="one-way-anova.html#null-hypothesis"><i class="fa fa-check"></i><b>8.5.1</b> Null hypothesis</a></li>
<li class="chapter" data-level="8.5.2" data-path="one-way-anova.html"><a href="one-way-anova.html#the-actual-anova"><i class="fa fa-check"></i><b>8.5.2</b> The actual ANOVA</a></li>
<li class="chapter" data-level="8.5.3" data-path="one-way-anova.html"><a href="one-way-anova.html#construct-the-model"><i class="fa fa-check"></i><b>8.5.3</b> Construct the model</a></li>
<li class="chapter" data-level="8.5.4" data-path="one-way-anova.html"><a href="one-way-anova.html#is-the-model-valid"><i class="fa fa-check"></i><b>8.5.4</b> Is the model valid?</a></li>
<li class="chapter" data-level="8.5.5" data-path="one-way-anova.html"><a href="one-way-anova.html#the-overall-picture"><i class="fa fa-check"></i><b>8.5.5</b> The overall picture</a></li>
<li class="chapter" data-level="8.5.6" data-path="one-way-anova.html"><a href="one-way-anova.html#the-detailed-picture"><i class="fa fa-check"></i><b>8.5.6</b> The detailed picture</a></li>
<li class="chapter" data-level="8.5.7" data-path="one-way-anova.html"><a href="one-way-anova.html#post-hoc-tsts."><i class="fa fa-check"></i><b>8.5.7</b> Post hoc tsts.</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="one-way-anova.html"><a href="one-way-anova.html#reporting-the-result."><i class="fa fa-check"></i><b>8.6</b> Reporting the Result.</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="paired-data.html"><a href="paired-data.html"><i class="fa fa-check"></i><b>9</b> Paired data</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="paired-data.html"><a href="paired-data.html#which-test-paired-t-test-or-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>9.0.1</b> Which test: paired t-test or Wilcoxon signed rank test?</a></li>
<li class="chapter" data-level="9.0.2" data-path="paired-data.html"><a href="paired-data.html#example"><i class="fa fa-check"></i><b>9.0.2</b> Example</a></li>
<li class="chapter" data-level="9.0.3" data-path="paired-data.html"><a href="paired-data.html#the-non-parametric-alternative-the-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>9.0.3</b> The non-parametric alternative: The Wilcoxon signed rank test</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data analysis for Newquay University Centre</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="paired-data" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Paired data<a href="paired-data.html#paired-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Often one has a sample of replicated data where each element has a counterpart in another matched sample - paired data. A common scenario for this is when there are data for the same individual at two different points in time, for example before and after some event such as the application of a treatment.</p>
<p>In order to determine whether there is a difference between the two sets, one should take the paired aspect into account and not simply match the whole before-set against the whole after-set without doing this. That would be to throw away the information whereby there is likely to be a greater degree of correlation between the responses of an individual before and after the event than there is between any randomly chosen pairs of individuals before and after the event.</p>
<div id="which-test-paired-t-test-or-wilcoxon-signed-rank-test" class="section level3 hasAnchor" number="9.0.1">
<h3><span class="header-section-number">9.0.1</span> Which test: paired t-test or Wilcoxon signed rank test?<a href="paired-data.html#which-test-paired-t-test-or-wilcoxon-signed-rank-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is a choice between at least two tests: the parametric paired t-test and the non-parametric Wilcoxon signed rank test. Ideally one would use the t-test since it is more powerful than the Wilcoxon test. This means several things, but in particular it means that, all else being equal, it can detect a small difference with higher probability than the Wilcoxon test can.</p>
<div id="the-paired-t-test" class="section level4 hasAnchor" number="9.0.1.1">
<h4><span class="header-section-number">9.0.1.1</span> The paired t-test<a href="paired-data.html#the-paired-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Where the data are numerical (ie not ordinal) and where the before and after data are both normally distributed around their respective mean values one would use the <em>paired t-test</em> in this scenario. One can test for normality using either a test such as the Shapiro-Wilk test, or graphically using either a histogram, a box plot, or (best), a quantile-quantile plot.</p>
</div>
<div id="the-wilcoxon-signed-rank-test" class="section level4 hasAnchor" number="9.0.1.2">
<h4><span class="header-section-number">9.0.1.2</span> The Wilcoxon Signed Rank test<a href="paired-data.html#the-wilcoxon-signed-rank-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The t-test, an example of a so-called parametric test, is actually pretty robust against departures from normality, but where one doubts its validity due to extreme non-normality or for other reasons such as the ordinal nature of the data, the Wilcoxon signed rank test is a useful non-parametric alternative. It is called non-parametric because it does not make any assumption about the distribution of the data values. It only uses their ranks, where the smallest value gets rank 1, the next smallest gets rank 2, and so on.</p>
<p>So, you typically use this test when you would like to use the paired t-test, but you cannot because one or both of the data sets is way off being normally distributed or is ordinal.</p>
</div>
<div id="null-hypotheses" class="section level4 hasAnchor" number="9.0.1.3">
<h4><span class="header-section-number">9.0.1.3</span> Null Hypotheses<a href="paired-data.html#null-hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In both the t-test and the Wilcoxon signed rank tests, the null hypothesis is the usual ‘nothing going on’, ‘there is no difference’ scenario, but there is a subtle difference between them that reflects the different information that they use. In the Wilcoxon signed rank test the null is that the difference between the <em>medians</em> of pairs of observations is zero. This is different from the null hypothesis of the paired t–test, which is that the difference between the <em>means</em> of pairs is zero.</p>
</div>
<div id="test-output" class="section level4 hasAnchor" number="9.0.1.4">
<h4><span class="header-section-number">9.0.1.4</span> Test output<a href="paired-data.html#test-output" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Both tests will give a p value. This is the probability that the mean (t-test) or median (Wilcoxon signed rank) paired differences between the corresponding before and after sample elements would be equal to or greater than it actually is for the data if the null hypothesis were true. If the p value is less than some pre-decided ‘significance level’, usually taken to be 0.05, then we reject the null hypothesis. If it is not, then we fail to reject the null hypothesis.</p>
</div>
</div>
<div id="example" class="section level3 hasAnchor" number="9.0.2">
<h3><span class="header-section-number">9.0.2</span> Example<a href="paired-data.html#example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will use as an example a data set from Laureysens et al. (2004) that has measurements of metal content in the wood of 13 poplar clones growing in a polluted area, once in August and once in November. The idea was to investigate the extent to which poplars could absorb metals from the soil and thus be useful in cleaning that up. Under a null hypothesis, there would be no difference between the metal concentrations in the plant tissue between August and November. Under an alternate hypothesis, there would be.</p>
<p>Laureysens, I. et al. (2004) ‘Clonal variation in heavy metal accumulation and biomass production in a poplar coppice culture: I. Seasonal variation in leaf, wood and bark concentrations’, Environmental Pollution, 131(3), pp. 485–494. Available at: <a href="https://doi.org/10.1016/j.envpol.2004.02.009" class="uri">https://doi.org/10.1016/j.envpol.2004.02.009</a>.</p>
<p>Concentrations of aluminum (in micrograms of Al per gram of wood) are shown below.</p>
<div id="load-packages-1" class="section level4 hasAnchor" number="9.0.2.1">
<h4><span class="header-section-number">9.0.2.1</span> Load packages<a href="paired-data.html#load-packages-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="paired-data.html#cb26-1" tabindex="-1"></a><span class="fu">library</span> (tidyverse)</span>
<span id="cb26-2"><a href="paired-data.html#cb26-2" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb26-3"><a href="paired-data.html#cb26-3" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># to make the plots look nice</span></span>
<span id="cb26-4"><a href="paired-data.html#cb26-4" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co"># for making nice tables</span></span></code></pre></div>
</div>
<div id="load-data" class="section level4 hasAnchor" number="9.0.2.2">
<h4><span class="header-section-number">9.0.2.2</span> Load data<a href="paired-data.html#load-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="paired-data.html#cb27-1" tabindex="-1"></a>filepath <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;poplars-paired_np.csv&quot;</span>)</span>
<span id="cb27-2"><a href="paired-data.html#cb27-2" tabindex="-1"></a>poplars <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(filepath,<span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="paired-data.html#cb28-1" tabindex="-1"></a><span class="co"># table of the data</span></span>
<span id="cb28-2"><a href="paired-data.html#cb28-2" tabindex="-1"></a>poplars <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="paired-data.html#cb28-3" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="otaeqywwtp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#otaeqywwtp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#otaeqywwtp thead, #otaeqywwtp tbody, #otaeqywwtp tfoot, #otaeqywwtp tr, #otaeqywwtp td, #otaeqywwtp th {
  border-style: none;
}

#otaeqywwtp p {
  margin: 0;
  padding: 0;
}

#otaeqywwtp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#otaeqywwtp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#otaeqywwtp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#otaeqywwtp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#otaeqywwtp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#otaeqywwtp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#otaeqywwtp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#otaeqywwtp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#otaeqywwtp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#otaeqywwtp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#otaeqywwtp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#otaeqywwtp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#otaeqywwtp .gt_spanner_row {
  border-bottom-style: hidden;
}

#otaeqywwtp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#otaeqywwtp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#otaeqywwtp .gt_from_md > :first-child {
  margin-top: 0;
}

#otaeqywwtp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#otaeqywwtp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#otaeqywwtp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#otaeqywwtp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#otaeqywwtp .gt_row_group_first td {
  border-top-width: 2px;
}

#otaeqywwtp .gt_row_group_first th {
  border-top-width: 2px;
}

#otaeqywwtp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#otaeqywwtp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#otaeqywwtp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#otaeqywwtp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#otaeqywwtp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#otaeqywwtp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#otaeqywwtp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#otaeqywwtp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#otaeqywwtp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#otaeqywwtp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#otaeqywwtp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#otaeqywwtp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#otaeqywwtp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#otaeqywwtp .gt_left {
  text-align: left;
}

#otaeqywwtp .gt_center {
  text-align: center;
}

#otaeqywwtp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#otaeqywwtp .gt_font_normal {
  font-weight: normal;
}

#otaeqywwtp .gt_font_bold {
  font-weight: bold;
}

#otaeqywwtp .gt_font_italic {
  font-style: italic;
}

#otaeqywwtp .gt_super {
  font-size: 65%;
}

#otaeqywwtp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#otaeqywwtp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#otaeqywwtp .gt_indent_1 {
  text-indent: 5px;
}

#otaeqywwtp .gt_indent_2 {
  text-indent: 10px;
}

#otaeqywwtp .gt_indent_3 {
  text-indent: 15px;
}

#otaeqywwtp .gt_indent_4 {
  text-indent: 20px;
}

#otaeqywwtp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Clone">Clone</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="August">August</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="November">November</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="ID" class="gt_row gt_right">1</td>
<td headers="Clone" class="gt_row gt_left">Balsam_Spire</td>
<td headers="August" class="gt_row gt_right">8.1</td>
<td headers="November" class="gt_row gt_right">11.2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">2</td>
<td headers="Clone" class="gt_row gt_left">Beaupre</td>
<td headers="August" class="gt_row gt_right">10.0</td>
<td headers="November" class="gt_row gt_right">16.3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">3</td>
<td headers="Clone" class="gt_row gt_left">Hazendans</td>
<td headers="August" class="gt_row gt_right">16.5</td>
<td headers="November" class="gt_row gt_right">15.3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">4</td>
<td headers="Clone" class="gt_row gt_left">Hoogvorst</td>
<td headers="August" class="gt_row gt_right">13.6</td>
<td headers="November" class="gt_row gt_right">15.6</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">5</td>
<td headers="Clone" class="gt_row gt_left">Raspalje</td>
<td headers="August" class="gt_row gt_right">9.5</td>
<td headers="November" class="gt_row gt_right">10.5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">6</td>
<td headers="Clone" class="gt_row gt_left">Unal</td>
<td headers="August" class="gt_row gt_right">8.3</td>
<td headers="November" class="gt_row gt_right">15.5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">7</td>
<td headers="Clone" class="gt_row gt_left">Columbia_River</td>
<td headers="August" class="gt_row gt_right">18.3</td>
<td headers="November" class="gt_row gt_right">12.7</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">8</td>
<td headers="Clone" class="gt_row gt_left">Fritzi_Pauley</td>
<td headers="August" class="gt_row gt_right">13.3</td>
<td headers="November" class="gt_row gt_right">11.1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">9</td>
<td headers="Clone" class="gt_row gt_left">Trichobel</td>
<td headers="August" class="gt_row gt_right">7.9</td>
<td headers="November" class="gt_row gt_right">19.9</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">10</td>
<td headers="Clone" class="gt_row gt_left">Gaver</td>
<td headers="August" class="gt_row gt_right">8.1</td>
<td headers="November" class="gt_row gt_right">20.4</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">11</td>
<td headers="Clone" class="gt_row gt_left">Gibecq</td>
<td headers="August" class="gt_row gt_right">8.9</td>
<td headers="November" class="gt_row gt_right">14.2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">12</td>
<td headers="Clone" class="gt_row gt_left">Primo</td>
<td headers="August" class="gt_row gt_right">12.6</td>
<td headers="November" class="gt_row gt_right">12.7</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">13</td>
<td headers="Clone" class="gt_row gt_left">Wolterson</td>
<td headers="August" class="gt_row gt_right">13.4</td>
<td headers="November" class="gt_row gt_right">36.8</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="plot-the-data-1" class="section level4 hasAnchor" number="9.0.2.3">
<h4><span class="header-section-number">9.0.2.3</span> Plot the data<a href="paired-data.html#plot-the-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Before we do any test on some data to find evidence for a difference or a trend, it is a good idea to plot the data. This will reveal whatever patterns there are in the data and how likely they are to reveal a truth about the population from which they have been drawn.</p>
</div>
<div id="tidy-the-data" class="section level4 hasAnchor" number="9.0.2.4">
<h4><span class="header-section-number">9.0.2.4</span> Tidy the data<a href="paired-data.html#tidy-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this case there is work to do before we can plot the data. The problem is that the data is ‘untidy’. The two levels of the factor <code>month</code> are spread across two columns, August and November. For plotting purposes it will be useful to ‘tidy’ the data so that there is only one column containing both levels of <code>month</code> and another containing the aluminium concentrations. The function <code>pivot_longer()</code> can do this for us:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="paired-data.html#cb29-1" tabindex="-1"></a>poplars_tidy <span class="ot">&lt;-</span> poplars <span class="sc">|&gt;</span></span>
<span id="cb29-2"><a href="paired-data.html#cb29-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span> (August<span class="sc">:</span>November,<span class="at">names_to=</span><span class="st">&quot;month&quot;</span>,<span class="at">values_to=</span><span class="st">&quot;Al_conc&quot;</span>)</span>
<span id="cb29-3"><a href="paired-data.html#cb29-3" tabindex="-1"></a><span class="fu">head</span>(poplars_tidy,<span class="dv">8</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="paired-data.html#cb29-4" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="ysxiqrqsxi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ysxiqrqsxi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ysxiqrqsxi thead, #ysxiqrqsxi tbody, #ysxiqrqsxi tfoot, #ysxiqrqsxi tr, #ysxiqrqsxi td, #ysxiqrqsxi th {
  border-style: none;
}

#ysxiqrqsxi p {
  margin: 0;
  padding: 0;
}

#ysxiqrqsxi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ysxiqrqsxi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ysxiqrqsxi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ysxiqrqsxi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ysxiqrqsxi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ysxiqrqsxi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ysxiqrqsxi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ysxiqrqsxi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ysxiqrqsxi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ysxiqrqsxi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ysxiqrqsxi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ysxiqrqsxi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ysxiqrqsxi .gt_spanner_row {
  border-bottom-style: hidden;
}

#ysxiqrqsxi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ysxiqrqsxi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ysxiqrqsxi .gt_from_md > :first-child {
  margin-top: 0;
}

#ysxiqrqsxi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ysxiqrqsxi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ysxiqrqsxi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ysxiqrqsxi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ysxiqrqsxi .gt_row_group_first td {
  border-top-width: 2px;
}

#ysxiqrqsxi .gt_row_group_first th {
  border-top-width: 2px;
}

#ysxiqrqsxi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ysxiqrqsxi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ysxiqrqsxi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ysxiqrqsxi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ysxiqrqsxi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ysxiqrqsxi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ysxiqrqsxi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ysxiqrqsxi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ysxiqrqsxi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ysxiqrqsxi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ysxiqrqsxi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ysxiqrqsxi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ysxiqrqsxi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ysxiqrqsxi .gt_left {
  text-align: left;
}

#ysxiqrqsxi .gt_center {
  text-align: center;
}

#ysxiqrqsxi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ysxiqrqsxi .gt_font_normal {
  font-weight: normal;
}

#ysxiqrqsxi .gt_font_bold {
  font-weight: bold;
}

#ysxiqrqsxi .gt_font_italic {
  font-style: italic;
}

#ysxiqrqsxi .gt_super {
  font-size: 65%;
}

#ysxiqrqsxi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ysxiqrqsxi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ysxiqrqsxi .gt_indent_1 {
  text-indent: 5px;
}

#ysxiqrqsxi .gt_indent_2 {
  text-indent: 10px;
}

#ysxiqrqsxi .gt_indent_3 {
  text-indent: 15px;
}

#ysxiqrqsxi .gt_indent_4 {
  text-indent: 20px;
}

#ysxiqrqsxi .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Clone">Clone</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Al_conc">Al_conc</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="ID" class="gt_row gt_right">1</td>
<td headers="Clone" class="gt_row gt_left">Balsam_Spire</td>
<td headers="month" class="gt_row gt_left">August</td>
<td headers="Al_conc" class="gt_row gt_right">8.1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">1</td>
<td headers="Clone" class="gt_row gt_left">Balsam_Spire</td>
<td headers="month" class="gt_row gt_left">November</td>
<td headers="Al_conc" class="gt_row gt_right">11.2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">2</td>
<td headers="Clone" class="gt_row gt_left">Beaupre</td>
<td headers="month" class="gt_row gt_left">August</td>
<td headers="Al_conc" class="gt_row gt_right">10.0</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">2</td>
<td headers="Clone" class="gt_row gt_left">Beaupre</td>
<td headers="month" class="gt_row gt_left">November</td>
<td headers="Al_conc" class="gt_row gt_right">16.3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">3</td>
<td headers="Clone" class="gt_row gt_left">Hazendans</td>
<td headers="month" class="gt_row gt_left">August</td>
<td headers="Al_conc" class="gt_row gt_right">16.5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">3</td>
<td headers="Clone" class="gt_row gt_left">Hazendans</td>
<td headers="month" class="gt_row gt_left">November</td>
<td headers="Al_conc" class="gt_row gt_right">15.3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">4</td>
<td headers="Clone" class="gt_row gt_left">Hoogvorst</td>
<td headers="month" class="gt_row gt_left">August</td>
<td headers="Al_conc" class="gt_row gt_right">13.6</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">4</td>
<td headers="Clone" class="gt_row gt_left">Hoogvorst</td>
<td headers="month" class="gt_row gt_left">November</td>
<td headers="Al_conc" class="gt_row gt_right">15.6</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Now we can plot the data as a box plot, with one box for August and one for November ie one for each level of the factor <code>month</code>. Had we not first tidied the data, we could not have done this.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="paired-data.html#cb30-1" tabindex="-1"></a>poplars_tidy <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="paired-data.html#cb30-2" tabindex="-1"></a>  <span class="co"># group = ID makes the lines join elements of each pair</span></span>
<span id="cb30-3"><a href="paired-data.html#cb30-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> Al_conc, <span class="at">fill =</span> month, <span class="at">colour =</span> month)) <span class="sc">+</span> </span>
<span id="cb30-4"><a href="paired-data.html#cb30-4" tabindex="-1"></a>  <span class="co"># alpa (= opacity) &lt; 1 in case any points are on top of each other</span></span>
<span id="cb30-5"><a href="paired-data.html#cb30-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size=</span><span class="dv">0</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="paired-data.html#cb30-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="paired-data.html#cb30-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span>ID),<span class="at">colour =</span> <span class="st">&quot;grey60&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="paired-data.html#cb30-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb30-9"><a href="paired-data.html#cb30-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Al conc.(mu g Al / g wood)&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="paired-data.html#cb30-10" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb30-11"><a href="paired-data.html#cb30-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="paired_data_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Does it look as though the difference between the medians could plausibly be zero for the population? Or, put another way, if it was zero, how big a fluke would this sample be? That is what the p value actually tells us.</p>
</div>
<div id="check-for-normality-of-differences" class="section level4 hasAnchor" number="9.0.2.5">
<h4><span class="header-section-number">9.0.2.5</span> Check for normality of differences<a href="paired-data.html#check-for-normality-of-differences" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Before we use the t-test, we need to check that it is OK to do so.
The null hypothesis of the Shapiro-Wilk test is that the data set given to it is drawn from a normally distributed population.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="paired-data.html#cb31-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(poplars<span class="sc">$</span>August<span class="sc">-</span>poplars<span class="sc">$</span>November)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  poplars$August - poplars$November
## W = 0.92667, p-value = 0.3081</code></pre>
<p>The p value is very high. Thus we can reasonably assume that the differences between the August and November aluminium concentrations in the sample could plausibly have been drawn from a normally distributed population, despite the outlier value in the November sample. Thus we can reasonably test for difference using a paired t-test.</p>
<p>We can do this in R using the function <code>t.test()</code>, where we give to the function both the August and the November data, knowing that each August value has a counterpart November value, and we set the argument <code>paired</code> to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="paired-data.html#cb33-1" tabindex="-1"></a><span class="fu">t.test</span>(poplars<span class="sc">$</span>August, poplars<span class="sc">$</span>November, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  poplars$August and poplars$November
## t = -2.3089, df = 12, p-value = 0.03956
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##  -9.5239348 -0.2760652
## sample estimates:
## mean difference 
##            -4.9</code></pre>
<p>All parts of the output have meaning and are useful, but here we will focus on just two:</p>
<ul>
<li>the p value is equal to 0.040. Hence, if we have chosen the usual significance value of 0.05, we can take this to mean that there is evidence of a significant difference between the August and November values.</li>
<li>the lower and upper bounds of the 95% confidence interval are (-9.52, -0.28). This tells us that if samples such as we have were collected again and again, then the mean difference between the August and the November paired values would be in this range 95% of the time. The key thing is that this range does not encompass zero. This means that we can be confident at the 95% level that there is a non-zero change on going from August to November, and, in particular, that the August value is lower than the November value.</li>
</ul>
</div>
</div>
<div id="the-non-parametric-alternative-the-wilcoxon-signed-rank-test" class="section level3 hasAnchor" number="9.0.3">
<h3><span class="header-section-number">9.0.3</span> The non-parametric alternative: The Wilcoxon signed rank test<a href="paired-data.html#the-non-parametric-alternative-the-wilcoxon-signed-rank-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To be safe, because of that outlier, let us test for difference using the Wilcoxon signed rank test. In R this is done using the function <code>wilcox.test()</code>, with the argument <code>paired</code> set to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="paired-data.html#cb35-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(poplars<span class="sc">$</span>August, poplars<span class="sc">$</span>November, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  poplars$August and poplars$November
## V = 16, p-value = 0.03979
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>We see that the conclusion (in this case) is the same.</p>
<div id="relation-to-one-sample-paired-test" class="section level4 hasAnchor" number="9.0.3.1">
<h4><span class="header-section-number">9.0.3.1</span> Relation to one-sample paired test<a href="paired-data.html#relation-to-one-sample-paired-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The two-sample paired tests as we have done above are the same as doing a one-sample test to see if the differences between the August and November paired values is different from zero. This is true whether we do a t-test or a Wilcoxon signed rank test.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="paired-data.html#cb37-1" tabindex="-1"></a><span class="fu">t.test</span>(poplars<span class="sc">$</span>August <span class="sc">-</span> poplars<span class="sc">$</span>November, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">data =</span> poplars)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  poplars$August - poplars$November
## t = -2.3089, df = 12, p-value = 0.03956
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -9.5239348 -0.2760652
## sample estimates:
## mean of x 
##      -4.9</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="paired-data.html#cb39-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(poplars<span class="sc">$</span>August <span class="sc">-</span> poplars<span class="sc">$</span>November, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">data =</span> poplars)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  poplars$August - poplars$November
## V = 16, p-value = 0.03979
## alternative hypothesis: true location is not equal to 0</code></pre>

<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div class="csl-entry">
Xie, Yihui. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="http://yihui.org/knitr/">http://yihui.org/knitr/</a>.
</div>
<div class="csl-entry">
———. 2024. <em>Bookdown: Authoring Books and Technical Documents with r Markdown</em>. <a href="https://github.com/rstudio/bookdown">https://github.com/rstudio/bookdown</a>.
</div>
</div>
</div>
</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="one-way-anova.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/paired_data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["fake-book.pdf", "fake-book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
